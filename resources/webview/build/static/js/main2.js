(this["webpackJsonpreact-app"]=this["webpackJsonpreact-app"]||[]).push([[0],{171:function(e,t,a){e.exports=a(332)},173:function(e,t,a){},178:function(e,t,a){},180:function(e,t,a){},181:function(e,t,a){},238:function(e,t,a){},243:function(e,t,a){},331:function(e,t,a){},332:function(e,t,a){"use strict";a.r(t);a(172),a(173);var r=a(0),s=a.n(r),n=a(10),o=a.n(n);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var i=a(25),c=a(17),l=(a(178),a(337)),u=a(167),m=a(9),h=a(23),p=a(21),g=a.n(p),d=a(33),f=a(27),v=a(28),b=a(30),y=a(29),E=a(31),S=(a(180),a(338)),O=a(11),w=a.n(O);function k(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}var j={postMessage:console.log};try{j=acquireVsCodeApi()}catch(Ae){}var N={};function P(e){var t=e.fnName,a=e.region;return new Promise((function(e){var r=Math.random();j.postMessage({command:"getLambdaOverview",messageId:r,payload:{fnName:t,region:a}}),N[r]=function(t){t.error?e({overviewProps:{},error:t.error}):e({overviewProps:t})}}))}function C(e){var t=e.logGroupName,a=e.nextToken,r=e.limit,s=e.region;return new Promise((function(e){var n=Math.random();j.postMessage({command:"getLogStreams",messageId:n,payload:{nextToken:a,limit:r,logGroupName:t,region:s}}),N[n]=function(t){t.ignore?e({logStreams:[],nextToken:a,timestamp:Date.now()}):t.error?e({logStreams:[],error:t.error,timestamp:Date.now()}):e({nextToken:t.nextToken,logStreams:t.logStreams,timestamp:Date.now()})}}))}function T(e){return new Promise((function(t,a){var r=Math.random();j.postMessage({command:"getLogEvents",messageId:r,payload:{nextToken:e.nextToken,logGroup:e.logGroup,logStream:e.logStream,region:e.region}}),N[r]=function(e){e.ignore?a({ignore:!0}):e.error?a(e.error):t({nextBackwardToken:e.nextBackwardToken,nextForwardToken:e.nextForwardToken,logEvents:e.logEvents})}}))}function R(e){return new Promise((function(t,a){var r=Math.random();j.postMessage({command:"addService",messageId:r,payload:e}),N[r]=function(e){e.error?a({message:e.error}):t()}}))}function x(e){return new Promise((function(t,a){var r=Math.random();j.postMessage({command:"startQuery",messageId:r,payload:e}),N[r]=function(e){e.error?a(e.error):t(e)}}))}function M(e){return new Promise((function(t,a){var r=Math.random();j.postMessage({command:"stopQuery",messageId:r,payload:e}),N[r]=function(e){e.error?a(e.error):t(e)}}))}function I(e){return new Promise((function(t,a){var r=Math.random();j.postMessage({command:"getQueryResults",messageId:r,payload:e}),N[r]=function(e){e.error?a({status:"Error",results:[]}):t(function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?k(a,!0).forEach((function(t){Object(h.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):k(a).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}({},e,{results:e.results.map((function(e){return e.reduce((function(e,t){return e[t.field]=t.value,e}),{})})).map((function(e){var t=6e4*(new Date).getTimezoneOffset();return{timestamp:w()(e["@timestamp"]).toDate().getTime()-t,messageShort:e["@message"].slice(0,500),messageLong:e["@message"]}}))}))}}))}window.addEventListener("message",(function(e){var t=e.data;N[t.messageId]&&N[t.messageId](t.payload)}));var q=a(339),F=a(68),L=a(118),D=a.n(L),A=(a(181),a(342)),G=a(157),W=a(154),B=a.n(W),Q=a(58);A.a.registerLanguage("json",G.a);var U=function(e){function t(e){var a;return Object(f.a)(this,t),(a=Object(b.a)(this,Object(y.a)(t).call(this,e))).state={copyStr:"copy JSON to clipboard",searched:!1,loaded:!1},a.myRef=void 0,a.myRef=s.a.createRef(),a}return Object(E.a)(t,e),Object(v.a)(t,[{key:"componentDidMount",value:function(){var e=this;setTimeout((function(){e.setState({loaded:!0})}),0)}},{key:"componentDidUpdate",value:function(){var e=this;if(this.props.search){!1===this.state.searched&&this.setState({searched:!0});var t=new D.a(this.myRef.current);t.unmark({done:function(){t.mark(e.props.search,{acrossElements:!0,separateWordSearch:!1})}})}else if(this.state.searched){new D.a(this.myRef.current).unmark()}}},{key:"renderWithJson",value:function(e){var t=this,a=function(e){var t=e.match(/{[\s\S]*}/);if(t)try{var a=JSON.parse(t[0]),r=e.split(t[0]);return[r[0],JSON.stringify(a,null,2),r[1]]}catch(Ae){return!1}return!1}(e);return a?s.a.createElement("div",{className:"logevent-longmessage"},s.a.createElement("div",null,a[0]),s.a.createElement("div",{className:"code-wrapper"},s.a.createElement(Q.a,{size:"small",onClick:function(e){e.currentTarget.blur(),B()(a[1]),t.setState({copyStr:"copied"}),setTimeout((function(){t.setState({copyStr:"copy JSON to clipboard"})}),1e3)}},this.state.copyStr),s.a.createElement(A.a,{className:"syntax-highlighter",useInlineStyles:!1,language:"json",showLineNumbers:!0},a[1])),s.a.createElement("div",null,a[2])):s.a.createElement("div",{className:"logevent-longmessage"},e)}},{key:"render",value:function(){return s.a.createElement("div",{ref:this.myRef},this.state.loaded?this.renderWithJson(this.props.message):s.a.createElement("div",null,"loading"))}}]),t}(s.a.Component);var z=function(e){function t(){var e,a;Object(f.a)(this,t);for(var r=arguments.length,s=new Array(r),n=0;n<r;n++)s[n]=arguments[n];return(a=Object(b.a)(this,(e=Object(y.a)(t)).call.apply(e,[this].concat(s)))).state={ping:0,message:""},a._intervalRef=void 0,a}return Object(E.a)(t,e),Object(v.a)(t,[{key:"initInterval",value:function(){var e=this,t=this.props.interval&&this.props.interval>500?this.props.interval:1e4;this._intervalRef=setInterval((function(){if(t<=5e3){var a=Math.round((Date.now()-e.props.time)/1e3);e.setState({ping:Date.now(),message:a<10&&"".concat(a," seconds ago")})}else e.setState({ping:Date.now()})}),t)}},{key:"componentDidMount",value:function(){this.initInterval()}},{key:"componentDidUpdate",value:function(e){e.interval!==this.props.interval&&this.initInterval()}},{key:"componentWillUnmount",value:function(){clearInterval(this._intervalRef)}},{key:"render",value:function(){return s.a.createElement("span",{className:this.props.className},this.state.message||w()(this.props.time).fromNow())}}]),t}(s.a.Component);function V(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}var H=S.a.Panel,_=function(e){function t(e){var a;return Object(f.a)(this,t),(a=Object(b.a)(this,Object(y.a)(t).call(this,e))).state=void 0,a._intervalRef=void 0,a.state={search:e.defaultSearch,groupPerRequest:document.vscodeData.groupPerRequest,loaded:!1,preparedMessages:[],messages:[]},a}return Object(E.a)(t,e),Object(v.a)(t,[{key:"componentDidMount",value:function(){var e=Object(d.a)(g.a.mark((function e(){var t,a,r,s;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,T({logGroup:this.props.logGroup,logStream:this.props.logStream,region:this.props.region});case 3:t=e.sent,a=t.logEvents,r=t.nextBackwardToken,s=t.nextForwardToken,this.setState({error:null,loaded:!0,nextBackwardToken:r,nextForwardToken:s,messages:a.map((function(e,t){return{timestamp:e.timestamp,messageShort:e.message.slice(0,500),messageLong:e.message}})),preparedMessages:K(a.map((function(e,t){return{timestamp:e.timestamp,messageShort:e.message.slice(0,500),messageLong:e.message}})),this.state.groupPerRequest,this.state.search)}),e.next=14;break;case 10:e.prev=10,e.t0=e.catch(0),this.setState({loaded:!0,error:e.t0}),e.t0.ignore||console.error(e.t0);case 14:this.initInterval();case 15:case"end":return e.stop()}}),e,this,[[0,10]])})));return function(){return e.apply(this,arguments)}}()},{key:"initInterval",value:function(){var e=this;clearInterval(this._intervalRef),this.props.isExpanded&&this.props.autoRefreshInterval>500&&this.props.isFirstLogStream&&(this._intervalRef=setInterval((function(){e.onRetryNew()}),this.props.autoRefreshInterval))}},{key:"componentDidUpdate",value:function(e){e.isExpanded===this.props.isExpanded&&e.isFirstLogStream===this.props.isFirstLogStream&&e.autoRefreshInterval===this.props.autoRefreshInterval||this.initInterval()}},{key:"onRetryNew",value:function(){var e=Object(d.a)(g.a.mark((function e(){var t,a,r;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.setState({loadingNew:!0}),e.prev=1,e.next=4,T({logGroup:this.props.logGroup,logStream:this.props.logStream,nextToken:this.state.nextForwardToken,region:this.props.region});case 4:t=e.sent,a=t.logEvents,r=t.nextForwardToken,this.setState({loadingNew:!1,error:null,messages:[].concat(Object(i.a)(this.state.messages),Object(i.a)(a.map((function(e,t){return{timestamp:e.timestamp,messageShort:e.message.slice(0,500),messageLong:e.message}})))),preparedMessages:K([].concat(Object(i.a)(this.state.messages),Object(i.a)(a.map((function(e,t){return{timestamp:e.timestamp,messageShort:e.message.slice(0,500),messageLong:e.message}})))),this.state.groupPerRequest,this.state.search),nextForwardToken:r}),e.next=14;break;case 10:e.prev=10,e.t0=e.catch(1),this.setState({loadingNew:!1,error:e.t0}),e.t0.ignore||console.error(e.t0);case 14:case"end":return e.stop()}}),e,this,[[1,10]])})));return function(){return e.apply(this,arguments)}}()},{key:"onRetryOld",value:function(){var e=Object(d.a)(g.a.mark((function e(){var t,a,r;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.setState({loadingOld:!0}),e.prev=1,e.next=4,T({logGroup:this.props.logGroup,logStream:this.props.logStream,nextToken:this.state.nextBackwardToken,region:this.props.region});case 4:t=e.sent,a=t.logEvents,r=t.nextBackwardToken,this.setState({loadingOld:!1,error:null,messages:[].concat(Object(i.a)(a.map((function(e,t){return{timestamp:e.timestamp,messageShort:e.message.slice(0,500),messageLong:e.message}}))),Object(i.a)(this.state.messages)),preparedMessages:K([].concat(Object(i.a)(a.map((function(e,t){return{timestamp:e.timestamp,messageShort:e.message.slice(0,500),messageLong:e.message}}))),Object(i.a)(this.state.messages)),this.state.groupPerRequest,this.state.search),nextBackwardToken:r}),e.next=14;break;case 10:e.prev=10,e.t0=e.catch(1),this.setState({loadingOld:!1,error:e.t0}),e.t0.ignore||console.error(e.t0);case 14:case"end":return e.stop()}}),e,this,[[1,10]])})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this;return this.state.loaded?[s.a.createElement("div",{className:"logstream-options",key:"options"},s.a.createElement(q.a.Search,{onChange:function(t){e.setState({search:t.target.value,preparedMessages:K(e.state.messages,e.state.groupPerRequest,t.target.value)})},value:this.state.search,placeholder:"search",allowClear:!0,size:"small"}),s.a.createElement(F.a,{checked:this.state.groupPerRequest,onChange:function(t){e.setState({groupPerRequest:t.target.checked,preparedMessages:K(e.state.messages,t.target.checked,e.state.search)})}},"Group per request")),s.a.createElement("div",{className:"retry-message retry-message-old",key:"retryold"},this.state.loadingOld?"loading older events...":s.a.createElement("span",null,"No older events found at the moment.",s.a.createElement("span",{className:"spanlink retry-link",onClick:this.onRetryOld.bind(this)},"Retry"))),s.a.createElement(S.a,{key:"collapse",bordered:!1},this.state.preparedMessages.map((function(t){return s.a.createElement(H,{key:t.key,className:0===t.searchMatches?"blurforsearch":"",header:s.a.createElement("div",{className:"logevent-header"},s.a.createElement(z,{className:"relative-time",time:t.timestamp}),s.a.createElement("span",{className:"abs-time"},w()(t.timestamp).format("lll")),s.a.createElement("span",{className:"logevent-shortmessage"},t.searchMatches>0&&s.a.createElement("span",{className:"event-tag matches"},"matches: ",t.searchMatches),t.shortMessageMatched&&t.shortMessageMatched.length?t.shortMessageMatched.map((function(e){return s.a.createElement("span",{className:"event-tag"},e)})):t.messageShort))},t.messagesLong.map((function(t,a){return s.a.createElement(U,{key:a,message:t,search:e.state.search})})))}))),this.state.error?s.a.createElement("div",{className:"error"},this.state.error):null,s.a.createElement("div",{className:"retry-message retry-message-new",key:"retrynew"},this.state.loadingNew?"loading new events...":s.a.createElement("span",null,"No newer events found at the moment.",s.a.createElement("span",{className:"spanlink retry-link",onClick:this.onRetryNew.bind(this)},"Retry")))]:s.a.createElement("div",{className:"retry-message"},"loading new events...")}}]),t}(s.a.Component);function K(e,t,a){var r=[],s=e.map((function(e,t){var s="",n=e.messageLong.match(/START RequestId: ([a-zA-z0-9-]*)/),o=e.messageLong.match(/REPORT RequestId: ([a-zA-z0-9-]*)/),i=!0,c=!1,l=void 0;try{for(var u,m=r[Symbol.iterator]();!(i=(u=m.next()).done);i=!0){var p=u.value;if(e.messageShort.includes(p)){s=p;break}}}catch(Ae){c=!0,l=Ae}finally{try{i||null==m.return||m.return()}finally{if(c)throw l}}n&&(r.push(n[1]),s=n[1]);var g=[];if(o){s=o[1];var d=e.messageShort.match(/Duration: (.*?) ms/),f=e.messageShort.match(/Max Memory Used: (.*?) MB/),v=e.messageShort.match(/Init Duration: (.*?) ms/);v&&g.push("init: ".concat(v[1]," ms")),d&&g.push("".concat(d[1]," ms")),f&&g.push("".concat(f[1]," MB"))}var b=-1;if(a){var y=a.replace(/\s\s+/g," ").toLowerCase(),E=function(e){var t=e.match(/{[\s\S]*}/);if(t)try{var a=JSON.parse(t[0]),r=e.split(t[0]);return"".concat(r[0],"\n      ").concat(JSON.stringify(a,null,2),"\n      ").concat(r[1])}catch(Ae){return e}return e}(e.messageLong).replace(/\s\s+/g," ").toLowerCase().match(new RegExp(y,"g"));b=E?E.length:0}var S="".concat(t,"-").concat(e.timestamp);return function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?V(a,!0).forEach((function(t){Object(h.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):V(a).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}({},e,{requestId:s||S,messagesLong:[e.messageLong],shortMessageMatched:g,searchMatches:b,index:t,key:S})}));if(!t)return s;var n=s.reduce((function(e,t){return e[t.requestId]?e[t.requestId].push(t):e[t.requestId]=[t],e}),{}),o=[];return Object.keys(n).forEach((function(e){var t,a=n[e],r=a.find((function(e){return e.shortMessageMatched.length}));r&&(t=r.shortMessageMatched),o.push({timestamp:a[0].timestamp,key:a[0].key,index:a[0].index,shortMessageMatched:t,searchMatches:a.reduce((function(e,t){return e+t.searchMatches}),0),messageShort:a[0].messageShort,messagesLong:a.map((function(e){return e.messageLong}))})})),o.sort((function(e,t){return e.index-t.index}))}var J=S.a.Panel,Y=function(e){function t(){var e,a;Object(f.a)(this,t);for(var r=arguments.length,s=new Array(r),n=0;n<r;n++)s[n]=arguments[n];return(a=Object(b.a)(this,(e=Object(y.a)(t)).call.apply(e,[this].concat(s)))).state={openedStreams:[]},a}return Object(E.a)(t,e),Object(v.a)(t,[{key:"render",value:function(){var e=this;return s.a.createElement("div",{className:"log-section"},s.a.createElement("header",null,s.a.createElement("h2",null,"Logs")),this.props.loaded?s.a.createElement("div",null,s.a.createElement(S.a,{className:"logstreamslist",onChange:function(t){return e.setState({openedStreams:t})}},this.props.error?s.a.createElement("div",{className:"foreground-color"},this.props.error):this.props.logStreams.sort((function(e,t){return t.sortByTimestamp-e.sortByTimestamp})).map((function(t,a){return s.a.createElement(J,{header:s.a.createElement("div",{className:"logstream"},s.a.createElement(z,{className:"relative-time",time:t.sortByTimestamp}),s.a.createElement("span",{className:"abs-time"},w()(t.sortByTimestamp).format("lll"))),key:t.arn},s.a.createElement(_,{isFirstLogStream:0===a,isExpanded:e.state.openedStreams.includes(t.arn),logGroup:e.props.tab.logs,region:e.props.tab.region,logStream:t.logStreamName,autoRefreshInterval:e.props.autoRefreshInterval}))}))),this.props.nextToken&&s.a.createElement("div",{className:" loadmore"},this.props.loadMoreInProgress?s.a.createElement("span",null,"loading..."):s.a.createElement("span",{className:"spanlink",onClick:this.props.onLoadMore},"Load more"))):s.a.createElement("div",null,"loading"))}}]),t}(s.a.Component),$=(a(238),a(341));function Z(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;if(0===e)return"0 Bytes";var a=t<0?0:t,r=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,r)).toFixed(a))+" "+["Bytes","KB","MB","GB","TB","PB","EB","ZB","YB"][r]}var X=$.a.Item;function ee(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return s.a.createElement("div",{className:"overview-section"},s.a.createElement("h2",null,"Overview"),s.a.createElement($.a,{size:"small",className:"overview-content"},s.a.createElement(X,{label:"Name"},s.a.createElement(te,{value:e.name,type:"string"})),s.a.createElement(X,{label:"Last Modified"},s.a.createElement(te,{value:e.lastModified,type:"relativeTime"})),s.a.createElement(X,{label:"Runtime"},s.a.createElement(te,{value:e.runtime,type:"string"})),s.a.createElement(X,{label:"Timeout"},s.a.createElement(te,{value:e.timeout,type:"seconds"})),s.a.createElement(X,{label:"Memory Size"},s.a.createElement(te,{value:e.memorySize,type:"megabytes"})),s.a.createElement(X,{label:"Code Size"},s.a.createElement(te,{value:e.codeSize,type:"bytes"}))))}function te(e){var t=e.value,a=e.type;if(!t)return s.a.createElement("span",null,"...");switch(a){case"string":return s.a.createElement("span",null,t);case"bytes":return s.a.createElement("span",null,Z(parseInt(t)));case"relativeTime":return s.a.createElement(z,{time:t});case"seconds":return s.a.createElement("span",null,t," seconds");case"megabytes":return s.a.createElement("span",null,t," MB")}}function ae(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}var re=function(e){function t(){var e,a;Object(f.a)(this,t);for(var r=arguments.length,s=new Array(r),n=0;n<r;n++)s[n]=arguments[n];return(a=Object(b.a)(this,(e=Object(y.a)(t)).call.apply(e,[this].concat(s)))).state={refreshClickedInProgres:!1,refreshInProgres:!1,loadMoreInProgress:!1,loaded:!1,error:"",currentToken:"",nextToken:"",logStreams:[],lastRefreshed:Date.now(),overviewProps:{lastModified:null,memorySize:null,runtime:null,timeout:null,codeSize:null}},a._intervalRef=void 0,a}return Object(E.a)(t,e),Object(v.a)(t,[{key:"componentDidMount",value:function(){var e=Object(d.a)(g.a.mark((function e(){var t,a,r,s,n,o;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C({logGroupName:this.props.tab.logs,region:this.props.tab.region});case 2:if(t=e.sent,a=t.logStreams,r=t.nextToken,s=t.error,n={},!this.props.tab.lambda){e.next=12;break}return e.next=10,P({fnName:this.props.tab.lambda,region:this.props.tab.region});case 10:o=e.sent,n=o.overviewProps;case 12:this.setState({error:s,loaded:!0,logStreams:a,overviewProps:n,nextToken:r}),this.initInterval();case 14:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"initInterval",value:function(){var e=this;clearInterval(this._intervalRef),this.props.autoRefreshInterval>500&&(this._intervalRef=setInterval((function(){e.props.isActive&&e.onAutoRefresh()}),this.props.autoRefreshInterval))}},{key:"componentDidUpdate",value:function(e){e.autoRefreshInterval!==this.props.autoRefreshInterval&&this.initInterval()}},{key:"onAutoRefresh",value:function(){var e=Object(d.a)(g.a.mark((function e(){var t,a,r,s,n;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.setState({refreshInProgres:!0}),e.next=3,C({logGroupName:this.props.tab.logs,limit:10,region:this.props.tab.region});case 3:t=e.sent,a=t.logStreams,r=t.error,s=t.timestamp,n=this.state.logStreams.filter((function(e){return!a.find((function(t){return t.arn===e.arn}))})),this.setState({error:r,logStreams:[].concat(Object(i.a)(n),Object(i.a)(a)),refreshInProgres:!1,refreshClickedInProgres:!1,lastRefreshed:s});case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"onRefresh",value:function(){var e=Object(d.a)(g.a.mark((function e(){var t,a,r,s,n,o,c,l,u=arguments;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=u.length>0&&void 0!==u[0]?u[0]:50,this.setState({refreshInProgres:!0}),e.next=4,C({logGroupName:this.props.tab.logs,limit:t,region:this.props.tab.region});case 4:if(a=e.sent,r=a.logStreams,s=a.error,n=a.timestamp,o=this.state.logStreams.filter((function(e){return!r.find((function(t){return t.arn===e.arn}))})),c={},!this.props.tab.lambda){e.next=15;break}return e.next=13,P({fnName:this.props.tab.lambda,region:this.props.tab.region});case 13:l=e.sent,c=l.overviewProps;case 15:this.setState({error:s,logStreams:[].concat(Object(i.a)(o),Object(i.a)(r)),refreshInProgres:!1,refreshClickedInProgres:!1,overviewProps:c,lastRefreshed:n});case 16:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"onLoadMore",value:function(){var e=Object(d.a)(g.a.mark((function e(){var t,a,r,s,n;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.setState({loadMoreInProgress:!0}),e.next=3,C({logGroupName:this.props.tab.logs,region:this.props.tab.region,nextToken:this.state.nextToken});case 3:t=e.sent,a=t.logStreams,r=t.nextToken,s=t.error,n=this.state.logStreams.filter((function(e){return!a.find((function(t){return t.arn===e.arn}))})),this.setState({error:s,loadMoreInProgress:!1,logStreams:[].concat(Object(i.a)(n),Object(i.a)(a)),nextToken:r});case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this;return s.a.createElement("div",null,s.a.createElement("div",{className:"refresh-option"},s.a.createElement("span",{className:"autorefresh"},"Auto Refresh:"," ",s.a.createElement("span",{className:"toggle",onClick:function(){var t,a=e.props.autoRefreshInterval>500;(t=!a,new Promise((function(e){var a=Math.random();j.postMessage({command:"setAutoRefresh",messageId:a,payload:{enabled:t}}),N[a]=function(t){e(t.autoRefreshInterval)}}))).then((function(t){e.props.onAutoRefreshChange(t)}))}},this.props.autoRefreshInterval>500?"ON":"OFF")),s.a.createElement("span",{className:"spanlink",onClick:function(){e.state.refreshInProgres||(e.setState({refreshClickedInProgres:!0}),e.onRefresh())}},this.state.refreshClickedInProgres?"Loading...":"Refresh"),s.a.createElement("div",{className:"last-refreshed"},"last refresh:"," ",s.a.createElement(z,{time:this.state.lastRefreshed,interval:this.props.autoRefreshInterval>500?1e3:null}))),this.props.tab.lambda&&s.a.createElement(ee,function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?ae(a,!0).forEach((function(t){Object(h.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):ae(a).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}({},this.state.overviewProps,{name:this.props.tab.lambda})),s.a.createElement(Y,{tab:this.props.tab,loaded:this.state.loaded,error:this.state.error,logStreams:this.state.logStreams,nextToken:this.state.nextToken,loadMoreInProgress:this.state.loadMoreInProgress,onLoadMore:this.onLoadMore.bind(this),autoRefreshInterval:this.props.autoRefreshInterval}))}}]),t}(s.a.Component),se=a(336),ne=a(335);a(243);function oe(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function ie(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?oe(a,!0).forEach((function(t){Object(h.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):oe(a).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var ce=q.a.Search,le=q.a.TextArea,ue=S.a.Panel,me="fields @timestamp, @message\n  | filter @message like /(?i)$SEARCH_INPUT/\n  | sort @timestamp asc\n  | limit 20",he=se.a.RangePicker,pe={"5m":3e5,"10m":6e5,"15m":9e5,"30m":18e5,"1h":36e5,"3h":108e5,"6h":216e5,"12h":432e5,"1d":864e5,"2d":1728e5,"3d":2592e5,"7d":6048e5,"30d":2592e6},ge={activeTimeFrame:"1h",customRange:[Date.now()-pe["3d"],Date.now()],searchStr:"",query:me,isQueryShown:!1,isHistoryShown:!1,activeQueryRef:"",queriesStatus:{}},de=function(e){function t(){var e,a;Object(f.a)(this,t);for(var r=arguments.length,s=new Array(r),n=0;n<r;n++)s[n]=arguments[n];return(a=Object(b.a)(this,(e=Object(y.a)(t)).call.apply(e,[this].concat(s)))).state=ge,a.onTimeFrameChange=function(e){a.setState({activeTimeFrame:e})},a}return Object(E.a)(t,e),Object(v.a)(t,[{key:"startQuery",value:function(){var e=Object(d.a)(g.a.mark((function e(t){var a,r,s,n,o;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a="custom"===this.state.activeTimeFrame?this.state.customRange:(i=this.state.activeTimeFrame,[Date.now()-pe[i],Date.now()]),r=t||Date.now().toString(),s=this.state.query.replace(/\$SEARCH_INPUT/g,this.state.searchStr),this.setState({activeQueryRef:r,queriesStatus:ie({},this.state.queriesStatus,Object(h.a)({},r,ie({},this.state.queriesStatus[r],{activeTimeFrame:this.state.activeTimeFrame,customRange:this.state.customRange,searchStr:this.state.searchStr,query:this.state.query,isRunning:!0,status:"Started",resultsWithoutMatches:[],resultsWithMatches:[]})))}),e.prev=4,e.next=7,x({ref:r,startTime:Math.round(a[0]/1e3),endTime:Math.round(a[1]/1e3),logGroupName:this.props.logGroupName,region:this.props.region,query:s});case 7:n=e.sent,o=n.queryId,this.setState({queriesStatus:ie({},this.state.queriesStatus,Object(h.a)({},r,ie({},this.state.queriesStatus[r],{queryId:o})))}),this.getQueryResults(r),e.next=16;break;case 13:e.prev=13,e.t0=e.catch(4),this.setState({activeQueryRef:r,queriesStatus:ie({},this.state.queriesStatus,Object(h.a)({},r,ie({},this.state.queriesStatus[r],{isRunning:!1,status:"Error",error:e.t0})))});case 16:case"end":return e.stop()}var i}),e,this,[[4,13]])})));return function(t){return e.apply(this,arguments)}}()},{key:"getQueryResults",value:function(){var e=Object(d.a)(g.a.mark((function e(t){var a,r,s=this;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.setState({queriesStatus:ie({},this.state.queriesStatus,Object(h.a)({},t,ie({},this.state.queriesStatus[t],{isRunning:!0})))}),a=this.state.queriesStatus[t].queryId,e.next=4,I({queryId:a,ref:t});case 4:r=e.sent,this.setState({queriesStatus:ie({},this.state.queriesStatus,Object(h.a)({},t,ie({},this.state.queriesStatus[t],{isRunning:"Complete"!==r.status&&"Failed"!==r.status&&"Cancelled"!==r.status,status:r.status,stats:r.statistics,resultsWithoutMatches:r.results,resultsWithMatches:K(r.results,!0,this.state.searchStr)})))}),"Running"!==r.status&&"Scheduled"!==r.status||setTimeout((function(){return s.getQueryResults(t)}),1e3);case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"stopQuery",value:function(){var e=Object(d.a)(g.a.mark((function e(){var t,a,r;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=0,a=Object.keys(this.state.queriesStatus);case 1:if(!(t<a.length)){e.next=15;break}if(r=a[t],!this.state.queriesStatus[r]||!this.state.queriesStatus[r].queryId||"Complete"===this.state.queriesStatus[r].status||"Failed"===this.state.queriesStatus[r].status||"Cancelled"===this.state.queriesStatus[r].status){e.next=12;break}return e.prev=4,e.next=7,M({queryId:this.state.queriesStatus[r].queryId});case 7:this.setState({queriesStatus:ie({},this.state.queriesStatus,Object(h.a)({},r,ie({},this.state.queriesStatus[r],{isRunning:!1,status:"Stop"})))}),e.next=12;break;case 10:e.prev=10,e.t0=e.catch(4);case 12:t++,e.next=1;break;case 15:case"end":return e.stop()}}),e,this,[[4,10]])})));return function(){return e.apply(this,arguments)}}()},{key:"onSearchInputChange",value:function(e){var t=this.state.queriesStatus[this.state.activeQueryRef]||{};this.setState({searchStr:e.target.value}),t.resultsWithoutMatches&&t.resultsWithoutMatches.length&&this.setState({queriesStatus:ie({},this.state.queriesStatus,Object(h.a)({},this.state.activeQueryRef,ie({},t,{resultsWithMatches:K(t.resultsWithoutMatches,!0,e.target.value)})))})}},{key:"render",value:function(){var e=this,t=this.state.queriesStatus[this.state.activeQueryRef]||{},a=t.searchStr&&t.searchStr===this.state.searchStr&&t.query===this.state.query&&t.activeTimeFrame===this.state.activeTimeFrame&&t.customRange===this.state.customRange;return s.a.createElement("div",{className:"search-page"},s.a.createElement("h2",null,"Search"),s.a.createElement(ce,{value:this.state.searchStr,onSearch:function(){e.state.searchStr&&(a?e.startQuery(e.state.activeQueryRef):e.startQuery())},onChange:this.onSearchInputChange.bind(this),loading:t.isRunning&&a,enterButton:a?"Refresh":"Search",addonAfter:t.isRunning?s.a.createElement(Q.a,{type:"danger",onClick:this.stopQuery.bind(this)},"Stop"):null}),s.a.createElement("div",{className:"search-options"},s.a.createElement("div",{className:"left belowinput"},s.a.createElement(fe,{timeframe:"5m",active:this.state.activeTimeFrame,onTimeFrameChange:this.onTimeFrameChange}),s.a.createElement("span",{className:"separator"},"|"),s.a.createElement(fe,{timeframe:"15m",active:this.state.activeTimeFrame,onTimeFrameChange:this.onTimeFrameChange}),s.a.createElement("span",{className:"separator"},"|"),s.a.createElement(fe,{timeframe:"30m",active:this.state.activeTimeFrame,onTimeFrameChange:this.onTimeFrameChange}),s.a.createElement("span",{className:"separator"},"|"),s.a.createElement(fe,{timeframe:"1h",active:this.state.activeTimeFrame,onTimeFrameChange:this.onTimeFrameChange}),s.a.createElement("span",{className:"separator"},"|"),s.a.createElement(fe,{timeframe:"6h",active:this.state.activeTimeFrame,onTimeFrameChange:this.onTimeFrameChange}),s.a.createElement("span",{className:"separator"},"|"),s.a.createElement(fe,{timeframe:"12h",active:this.state.activeTimeFrame,onTimeFrameChange:this.onTimeFrameChange}),s.a.createElement("span",{className:"separator"},"|"),s.a.createElement(fe,{timeframe:"1d",active:this.state.activeTimeFrame,onTimeFrameChange:this.onTimeFrameChange}),s.a.createElement("span",{className:"separator"},"|"),s.a.createElement(fe,{timeframe:"7d",active:this.state.activeTimeFrame,onTimeFrameChange:this.onTimeFrameChange}),s.a.createElement("span",{className:"separator"},"|"),s.a.createElement(fe,{timeframe:"30d",active:this.state.activeTimeFrame,onTimeFrameChange:this.onTimeFrameChange}),s.a.createElement("span",{className:"separator"},"|"),s.a.createElement(fe,{timeframe:"custom",active:this.state.activeTimeFrame,onTimeFrameChange:this.onTimeFrameChange})),s.a.createElement("div",{className:"right belowinput"},s.a.createElement("span",{className:this.state.isQueryShown?"whitelink active":"whitelink",onClick:function(){return e.setState({isQueryShown:!e.state.isQueryShown,isHistoryShown:!1})}},"query"),Object.keys(this.state.queriesStatus).length?[s.a.createElement("span",{className:"separator"},"|"),s.a.createElement("span",{className:this.state.isHistoryShown?"whitelink active":"whitelink",onClick:function(){return e.setState({isHistoryShown:!e.state.isHistoryShown,isQueryShown:!1})}},"history (",Object.keys(this.state.queriesStatus).length,")")]:null)),"custom"===this.state.activeTimeFrame&&s.a.createElement(he,{size:"small",style:{marginBottom:10},showTime:{format:"HH:mm"},format:"YYYY-MM-DD HH:mm",placeholder:["Start Time","End Time"],value:[w()(this.state.customRange[0]),w()(this.state.customRange[1])],ranges:{"This Week":[w()().startOf("week"),w()().endOf("week")],"This Month":[w()().startOf("month"),w()().endOf("month")],"This Year":[w()().startOf("year"),w()().endOf("year")]},onChange:function(t){e.setState({customRange:[parseInt(t[0].format("x")),parseInt(t[1].format("x"))]})}}),this.state.isQueryShown&&s.a.createElement("div",{className:"search-query"},s.a.createElement(le,{value:this.state.query,rows:4,onChange:function(t){return e.setState({query:t.target.value})}}),s.a.createElement("div",{className:"links"},this.state.query!==me&&[s.a.createElement("span",{className:"reset whitelink",onClick:function(){return e.setState({query:me})}},"reset"),s.a.createElement("span",{className:"separator"},"|")],s.a.createElement("a",{href:"https://docs.aws.amazon.com/AmazonCloudWatch/latest/logs/CWL_QuerySyntax.html",className:"whitelink",target:"_blank"},"more info"))),this.state.isHistoryShown&&s.a.createElement(ve,{queriesStatus:this.state.queriesStatus,active:this.state.activeQueryRef,onRowClick:function(t){var a=e.state.queriesStatus[t];e.setState({activeQueryRef:t,searchStr:a.searchStr,activeTimeFrame:a.activeTimeFrame,customRange:a.customRange,query:a.query,queriesStatus:ie({},e.state.queriesStatus,Object(h.a)({},t,ie({},e.state.queriesStatus[t],{resultsWithMatches:K(a.resultsWithoutMatches,!0,a.searchStr)})))})}}),s.a.createElement(be,{activeQuery:t}),t.resultsWithMatches&&t.resultsWithMatches.length?s.a.createElement("div",{className:"results"},s.a.createElement(S.a,{key:"collapse",bordered:!1},t.resultsWithMatches.map((function(t){return s.a.createElement(ue,{key:e.state.activeQueryRef+t.key,className:0===t.searchMatches?"blurforsearch":"",header:s.a.createElement("div",{className:"logevent-header"},s.a.createElement(z,{className:"relative-time",time:t.timestamp}),s.a.createElement("span",{className:"abs-time"},w()(t.timestamp).format("lll")),s.a.createElement("span",{className:"logevent-shortmessage"},t.searchMatches>0&&s.a.createElement("span",{className:"event-tag matches"},"matches: ",t.searchMatches),t.shortMessageMatched&&t.shortMessageMatched.length?t.shortMessageMatched.map((function(e){return s.a.createElement("span",{className:"event-tag"},e)})):t.messageShort))},t.messagesLong.map((function(t,a){return s.a.createElement(U,{key:a,message:t,search:e.state.searchStr})})))})))):null)}}]),t}(s.a.Component);function fe(e){var t=e.timeframe,a=e.active,r=e.onTimeFrameChange;return s.a.createElement("span",{className:"whitelink ".concat(a===t?"active":""),onClick:function(){return r(t)}},t)}function ve(e){var t=e.queriesStatus,a=e.onRowClick,r=e.active,n=[{title:"Search",dataIndex:"searchStr",key:"searchStr",width:"34%",render:function(e){return s.a.createElement("span",{className:"search-str"},s.a.createElement(m.a,{type:"right"}),e)}},{title:"Timeframe",dataIndex:"timeframe",key:"timeframe",render:function(e){return s.a.createElement("span",null,"Timeframe: ",e)},width:"22%"},{title:"Results",dataIndex:"results",key:"results",align:"right",render:function(e){return s.a.createElement("span",null,"Results: ",e)},width:"22%"},{title:"Status",dataIndex:"status",align:"right",key:"status",width:"22%"}],o=Object.keys(t).reverse().map((function(e){return{key:e,searchStr:t[e].searchStr,results:t[e].resultsWithMatches.length,status:t[e].status,timeframe:t[e].activeTimeFrame,ellipsis:!0}}));return s.a.createElement(ne.a,{size:"small",columns:n,dataSource:o,pagination:!1,showHeader:!1,scroll:{y:150,x:!1},onRowClick:function(e){a(e.key)},rowClassName:function(e){return e.key===r?"active":""}})}function be(e){var t=e.activeQuery;return s.a.createElement("div",{className:"fetching"},t&&("Running"===t.status||"Started"===t.status)&&s.a.createElement("span",{style:{marginRight:5}},"Fetching data..."),t&&t.stats&&s.a.createElement("span",null,s.a.createElement("b",null,t.stats.recordsMatched)," record",1===t.stats.recordsMatched?"":"s"," matched |"," ",s.a.createElement("b",null,t.stats.recordsScanned)," record",1===t.stats.recordsScanned?"":"s"," (",s.a.createElement("b",null,Z(t.stats.bytesScanned)),") scanned"),t&&"Error"===t.status&&s.a.createElement("div",{style:{marginTop:10}},t.error||"error running query"," "))}var ye=l.a.TabPane;var Ee=a(75),Se=a(340),Oe=a(168),we=function(e){function t(){var e,a;Object(f.a)(this,t);for(var r=arguments.length,s=new Array(r),n=0;n<r;n++)s[n]=arguments[n];return(a=Object(b.a)(this,(e=Object(y.a)(t)).call.apply(e,[this].concat(s)))).state={inputVisible:!1,inputValue:""},a.handleClose=function(e){var t=a.props.stages.filter((function(t){return t!==e}));a.props.onStagesChange(t)},a.showInput=function(){a.setState({inputVisible:!0},(function(){return a.input.focus()}))},a.handleInputChange=function(e){a.setState({inputValue:e.target.value})},a.handleInputConfirm=function(){var e=a.state.inputValue,t=a.props.stages;e&&-1===t.indexOf(e)&&(t=[].concat(Object(i.a)(t),[e])),a.props.onStagesChange(t),a.setState({inputVisible:!1,inputValue:""})},a.saveInputRef=function(e){return a.input=e},a.input=void 0,a}return Object(E.a)(t,e),Object(v.a)(t,[{key:"render",value:function(){var e=this,t=this.state,a=t.inputVisible,r=t.inputValue;return s.a.createElement("div",null,this.props.stages.map((function(t){return s.a.createElement(Oe.a,{key:t,closable:!0,onClose:function(){return e.handleClose(t)}},t)})),a&&s.a.createElement(q.a,{ref:this.saveInputRef,type:"text",size:"small",style:{width:78},value:r,onChange:this.handleInputChange,onBlur:this.handleInputConfirm,onPressEnter:this.handleInputConfirm}),!a&&s.a.createElement(Oe.a,{onClick:this.showInput,style:{borderStyle:"dashed"}},s.a.createElement(m.a,{type:"plus"})," Add stage"))}}]),t}(s.a.Component),ke=Ee.a.Option;function je(e){return s.a.createElement(Ee.a,{showSearch:!0,defaultValue:e.region,style:e.style||{width:"100%"},onChange:e.setRegion,optionFilterProp:"children",filterOption:function(e,t){return t.props.children.toLowerCase().indexOf(e.toLowerCase())>=0}},s.a.createElement(ke,{value:"us-east-2"},"us-east-2 (US East, Ohio)"),s.a.createElement(ke,{value:"us-east-1"},"us-east-1 (US East, N. Virginia)"),s.a.createElement(ke,{value:"us-west-1"},"us-west-1 (US West, N. California)"),s.a.createElement(ke,{value:"us-west-2"},"us-west-2 (US West, Oregon)"),s.a.createElement(ke,{value:"ap-east-1"},"ap-east-1 (Asia Pacific, Hong Kong)"),s.a.createElement(ke,{value:"ap-south-1"},"ap-south-1 (Asia Pacific, Mumbai)"),s.a.createElement(ke,{value:"ap-northeast-3"},"ap-northeast-3 (Asia Pacific, Osaka-Local)"),s.a.createElement(ke,{value:"ap-northeast-2"},"ap-northeast-2 (Asia Pacific, Seoul)"),s.a.createElement(ke,{value:"ap-southeast-1"},"ap-southeast-1 (Asia Pacific, Singapore)"),s.a.createElement(ke,{value:"ap-southeast-2"},"ap-southeast-2 (Asia Pacific, Sydney)"),s.a.createElement(ke,{value:"ap-northeast-1"},"ap-northeast-1 (Asia Pacific, Tokyo)"),s.a.createElement(ke,{value:"ca-central-1"},"ca-central-1 (Canada, Central)"),s.a.createElement(ke,{value:"cn-north-1"},"cn-north-1 (China, Beijing)"),s.a.createElement(ke,{value:"cn-northwest-1"},"cn-northwest-1 (China, Ningxia)"),s.a.createElement(ke,{value:"eu-central-1"},"eu-central-1 (EU, Frankfurt)"),s.a.createElement(ke,{value:"eu-west-1"},"eu-west-1 (EU, Ireland)"),s.a.createElement(ke,{value:"eu-west-2"},"eu-west-2 (EU, London)"),s.a.createElement(ke,{value:"eu-west-3"},"eu-west-3 (EU, Paris)"),s.a.createElement(ke,{value:"eu-north-1"},"eu-north-1 (EU, Stockholm)"),s.a.createElement(ke,{value:"me-south-1"},"me-south-1 (Middle East, Bahrain)"),s.a.createElement(ke,{value:"sa-east-1"},"sa-east-1 (South America, Sao Paulo)"),s.a.createElement(ke,{value:"us-gov-east-1"},"us-gov-east-1 (AWS GovCloud, US-East)"),s.a.createElement(ke,{value:"us-gov-west-1"},"us-gov-west-1 (AWS GovCloud, US-West)"))}var Ne=Ee.a.Option;function Pe(e){var t=Object(r.useState)(),a=Object(c.a)(t,2),n=a[0],o=a[1],i=Object(r.useState)(!0),l=Object(c.a)(i,2),u=l[0],m=l[1],h=Object(r.useState)([]),p=Object(c.a)(h,2),g=p[0],d=p[1],f=Object(r.useState)(e.defaultRegion),v=Object(c.a)(f,2),b=v[0],y=v[1],E=Object(r.useState)(e.defaultStackName),S=Object(c.a)(E,2),O=S[0],w=S[1];return Object(r.useEffect)((function(){m(!0),function(e){var t=e.region,a=e.awsProfile;return new Promise((function(e){var r=Math.random();j.postMessage({command:"listCloudFormationStacks",messageId:r,payload:{region:t,awsProfile:a}}),N[r]=function(t){t.error?e({stacks:[],error:t.error}):e({stacks:t.stacks})}}))}({region:b,awsProfile:e.awsProfile}).then((function(e){var t=e.stacks,a=e.error;m(!1),o(a),d(t),w(t[0])}))}),[b]),Object(r.useEffect)((function(){e.onChange(O,e.stage,b)}),[O]),s.a.createElement("table",null,s.a.createElement("tr",null,s.a.createElement("td",{style:{width:100}},"Region"),s.a.createElement("td",null,s.a.createElement(je,{region:b,setRegion:y,style:{width:250}}))),s.a.createElement("tr",null,s.a.createElement("td",{style:{minWidth:100}},"Stack name"),s.a.createElement("td",null,u?s.a.createElement("div",null,"loading..."):n?s.a.createElement("div",null,n):0===g.length?s.a.createElement("div",null,"No stacks found"):s.a.createElement(Ee.a,{showSearch:!0,style:{width:250},value:O,onChange:w,placeholder:"Select a CloudFormation Stack",optionFilterProp:"children",filterOption:function(e,t){return t.props.children.toLowerCase().indexOf(e.toLowerCase())>=0}},g.map((function(e){return s.a.createElement(Ne,{key:e,value:e},e)}))))))}var Ce=Ee.a.Option;function Te(e){var t=Object(r.useState)(),a=Object(c.a)(t,2),n=a[0],o=a[1],i=Object(r.useState)(!0),l=Object(c.a)(i,2),u=l[0],m=l[1],h=Object(r.useState)([]),p=Object(c.a)(h,2),g=p[0],d=p[1],f=Object(r.useState)(e.defaultRegion),v=Object(c.a)(f,2),b=v[0],y=v[1],E=Object(r.useState)(e.defaultLogGroup),S=Object(c.a)(E,2),O=S[0],w=S[1],k=Object(r.useState)(!Boolean(e.title)),P=Object(c.a)(k,2),C=P[0],T=P[1],R=Object(r.useState)(e.title),x=Object(c.a)(R,2),M=x[0],I=x[1],L=s.a.createRef();return Object(r.useEffect)((function(){m(!0),function(e){var t=e.region,a=e.awsProfile;return new Promise((function(e){var r=Math.random();j.postMessage({command:"describeLogGroups",messageId:r,payload:{region:t,awsProfile:a}}),N[r]=function(t){t.error?e({logGroups:[],error:t.error}):e({logGroups:t.logGroups})}}))}({region:b,awsProfile:e.awsProfile}).then((function(e){var t=e.logGroups,a=e.error;m(!1),o(a),d(t),w(t[0])}))}),[b]),Object(r.useEffect)((function(){e.onChange({logGroupName:O,stage:e.stage,region:b,useLogGroupName:C,customTitle:M})}),[O,C,M]),s.a.createElement("table",null,s.a.createElement("tr",null,s.a.createElement("td",{style:{width:100}},"Region"),s.a.createElement("td",null,s.a.createElement(je,{region:b,setRegion:y,style:{width:250}}))),s.a.createElement("tr",null,s.a.createElement("td",{style:{minWidth:100}},"Log Group"),s.a.createElement("td",null,u?s.a.createElement("div",null,"loading..."):n?s.a.createElement("div",null,n):0===g.length?s.a.createElement("div",null,"No stacks found"):s.a.createElement(Ee.a,{showSearch:!0,style:{width:250},value:O,onChange:w,placeholder:"Select a CloudFormation Stack",optionFilterProp:"children",filterOption:function(e,t){return t.props.children.toLowerCase().indexOf(e.toLowerCase())>=0}},g.map((function(e){return s.a.createElement(Ce,{key:e,value:e},e)}))))),s.a.createElement("tr",null,s.a.createElement("td",{className:"td-left"},"Title"),e.showTitle?s.a.createElement("td",null,s.a.createElement(F.a,{className:"config-title",style:{width:150,opacity:C?1:.5},checked:C,onChange:function(e){T(e.target.checked),L.current.focus()}},"Use Log Group name"),s.a.createElement(q.a,{style:{width:100,opacity:C?0:1},ref:L,value:M,onChange:function(e){return I(e.target.value)}})):s.a.createElement("td",null,"will be the same as in first stage")))}function Re(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function xe(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?Re(a,!0).forEach((function(t){Object(h.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Re(a).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var Me=l.a.TabPane,Ie=function(e){function t(e){var a;return Object(f.a)(this,t),(a=Object(b.a)(this,Object(y.a)(t).call(this,e))).newTabIndex=void 0,a.state=void 0,a.onChange=function(e){a.setState({activeKey:e})},a.onEdit=function(e,t){a[t](e)},a.add=function(){if(!a.state.newStageVal||a.state.panes.find((function(e){return e.stage===a.state.newStageVal})))return!1;var e=a.state.panes,t=a.state.newStageVal;e.push({stage:a.state.newStageVal}),a.setState({panes:e,activeKey:t,newStageVal:""})},a.remove=function(e){var t,r=a.state.activeKey;a.state.panes.forEach((function(a,r){a.stage===e&&(t=r-1)}));var s=a.state.panes.filter((function(t){return t.stage!==e}));s.length&&r===e&&(r=t>=0?s[t].stage:s[0].stage),a.setState({panes:s,activeKey:r}),a.props.onChange(s)},a.newTabIndex=0,a.state={newStageVal:"",activeKey:e.defaultStages[0].stage,panes:e.defaultStages},a}return Object(E.a)(t,e),Object(v.a)(t,[{key:"render",value:function(){var e=this;return s.a.createElement("div",{style:{display:"flex",justifyContent:"space-between"}},s.a.createElement("div",{style:{width:"70%",maxWidth:450}},s.a.createElement(l.a,{hideAdd:!0,onChange:this.onChange,activeKey:this.state.activeKey,size:"small",type:"editable-card",animated:!0,onEdit:this.onEdit},this.state.panes.map((function(t,a){return s.a.createElement(Me,{tab:t.stage,key:t.stage},"cloudformation"===e.props.source&&s.a.createElement(Pe,{awsProfile:e.props.awsProfile,defaultRegion:t.region||e.props.defaultRegion,defaultStackName:t.stage,stage:e.state.activeKey,onChange:function(t,a,r){var s=e.state.panes.map((function(e){return e.stage===a?xe({},e,{region:r,stackName:t}):e}));e.setState({panes:s}),e.props.onChange(s)}}),"custom"===e.props.source&&s.a.createElement(Te,{awsProfile:e.props.awsProfile,defaultRegion:t.region||e.props.defaultRegion,defaultLogGroup:t.stage,stage:e.state.activeKey,showTitle:0===a,onChange:function(t){var a=t.logGroupName,r=t.stage,s=t.region,n=t.useLogGroupName,o=t.customTitle,i=e.state.panes.map((function(e){return e.stage===r?xe({},e,{region:s,logGroupName:a,useLogGroupName:n,customTitle:o}):e}));e.setState({panes:i}),e.props.onChange(i)}}))})))),s.a.createElement("div",{style:{width:"30%",marginTop:8}},s.a.createElement(q.a,{style:{borderTop:0,borderLeft:0,borderRight:0},value:this.state.newStageVal,onChange:function(t){return e.setState({newStageVal:t.target.value})},placeholder:"add new stage",onPressEnter:this.add})))}}]),t}(s.a.Component);function qe(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function Fe(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?qe(a,!0).forEach((function(t){Object(h.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):qe(a).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var Le=Ee.a.Option;function De(e){var t=Object(r.useState)(e.source),a=Object(c.a)(t,2),n=a[0],o=a[1],i=Object(r.useState)(e.awsProfile),l=Object(c.a)(i,2),u=l[0],p=l[1],f=Object(r.useState)(e.title),v=Object(c.a)(f,2),b=v[0],y=v[1],E=Object(r.useState)(e.title),S=Object(c.a)(E,2),O=S[0],w=S[1],k=Object(r.useState)(e.title),j=Object(c.a)(k,2),N=j[0],P=j[1],C=Object(r.useState)(!Boolean(e.title)),T=Object(c.a)(C,2),x=T[0],M=T[1],I=Object(r.useState)(e.cwd),L=Object(c.a)(I,2),D=L[0],A=L[1],G=Object(r.useState)(e.print),W=Object(c.a)(G,2),B=W[0],U=W[1],z=Object(r.useState)(e.offset),V=Object(c.a)(z,2),H=V[0],_=V[1],K=Object(r.useState)(e.stages),J=Object(c.a)(K,2),Y=J[0],$=J[1],Z=Object(r.useState)({}),X=Object(c.a)(Z,2),ee=X[0],te=X[1],ae=Object(r.useState)([]),re=Object(c.a)(ae,2),se=re[0],ne=re[1],oe=Object(r.useState)([]),ie=Object(c.a)(oe,2),ce=ie[0],le=ie[1],ue=Object(r.useState)(e.customLogs),me=Object(c.a)(ue,2),he=me[0],pe=me[1],ge=Object(r.useState)(""),de=Object(c.a)(ge,2),fe=de[0],ve=de[1],be=Object(r.useState)(!1),ye=Object(c.a)(be,2),Oe=ye[0],ke=ye[1],je=s.a.createRef(),Ne=function(){var t=Object(d.a)(g.a.mark((function t(a){var r,s,i,c;return g.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(ve(""),r=[],s=[],u||(r.push("awsProfile"),s.push("AWS Profile is required")),"serverless"!==n){t.next=22;break}if(B||(r.push("print"),s.push("Print command is required")),D||(r.push("cwd"),s.push("Relative directory is required")),b||x||(r.push("title"),s.push("Title is required")),0===Y.length&&(r.push("stages"),s.push("At least one stage must be defined")),0!==s.length){t.next=20;break}return ke(!0),t.prev=11,t.next=14,R({source:n,awsProfile:u,cwd:D,print:B,offset:H,stages:Y,stacks:ee,title:x?null:b});case 14:t.next=19;break;case 16:t.prev=16,t.t0=t.catch(11),s.push(t.t0.message);case 19:ke(!1);case 20:t.next=51;break;case 22:if("cloudformation"!==n){t.next=39;break}if(O||(r.push("cfTitle"),s.push("Title is required")),0===ee.length&&s.push("At least one stage must be defined"),ee.length&&ee.find((function(e){return!e.stackName}))&&(i=ee.find((function(e){return!e.stackName})),s.push("Missing stack name in stage ".concat(i.title))),0!==s.length){t.next=37;break}return ke(!0),t.prev=28,t.next=31,R({source:n,awsProfile:u,offset:H,stacks:ee,title:O});case 31:t.next=36;break;case 33:t.prev=33,t.t1=t.catch(28),s.push(t.t1.message);case 36:ke(!1);case 37:t.next=51;break;case 39:if(N||(r.push("customTitle"),s.push("Title is required")),0===(c=Object.values(he).map((function(e){var t={title:e[0].useLogGroupName&&e[0].logGroupName?e[0].logGroupName:e[0].customTitle,tabs:e.map((function(e){return e.logGroupName||s.push("Missing log in stage ".concat(e.stage)),{region:e.region,title:e.stage,logs:e.logGroupName}}))};return t.title||s.push("Missing title in stage ".concat(e[0].stage)),t}))).length&&s.push("At least one stage must be defined"),0!==s.length){t.next=51;break}return t.prev=43,t.next=46,R({source:n,awsProfile:u,offset:H,items:c,title:N});case 46:t.next=51;break;case 48:t.prev=48,t.t2=t.catch(43),s.push(t.t2.message);case 51:0===s.length&&(ve("Service successfully added"),o(e.source),p(e.awsProfile),y(e.title),w(e.title),M(!Boolean(e.title)),A(e.cwd),U(e.print),_(e.offset),$(e.stages)),ne(r),le(s);try{a.target.blur()}catch(Ae){}case 55:case"end":return t.stop()}}),t,null,[[11,16],[28,33],[43,48]])})));return function(e){return t.apply(this,arguments)}}();return s.a.createElement("div",null,s.a.createElement("table",{className:"form-table"},s.a.createElement("tr",null,s.a.createElement("td",{className:"td-left"},"Source"),s.a.createElement("td",null,s.a.createElement(Ee.a,{value:n,className:se.includes("source")&&"error",style:{width:"100%"},onChange:o},s.a.createElement(Le,{value:"serverless"},"Serverless Framework (AWS)"),s.a.createElement(Le,{value:"cloudformation"},"CloudFormation (AWS)"),s.a.createElement(Le,{value:"custom"},"Custom (AWS)")))),s.a.createElement("tr",null,s.a.createElement("td",{className:"td-left"},"AWS Profile"),s.a.createElement("td",null,s.a.createElement(q.a,{className:se.includes("awsProfile")&&"error",value:u,onChange:function(e){return p(e.target.value)}}))),s.a.createElement("tr",null,s.a.createElement("td",{className:"td-left"},"Time offset (minutes)"),s.a.createElement("td",null,s.a.createElement(Se.a,{className:se.includes("offset")&&"error",value:H,onChange:function(e){_("number"===typeof e?e:0)}}))),"serverless"===n&&[s.a.createElement("tr",null,s.a.createElement("td",{className:"td-left"},"Title"),s.a.createElement("td",null,s.a.createElement(F.a,{className:"config-title",style:{opacity:x?1:.5},checked:x,onChange:function(e){M(e.target.checked),je.current.focus()}},"Use config service name"),s.a.createElement(q.a,{className:se.includes("title")?"error custom-title":"custom-title",style:{opacity:x?0:1},ref:je,value:b,onChange:function(e){return y(e.target.value)}}))),s.a.createElement("tr",null,s.a.createElement("td",{className:"td-left"},"Relative directory"),s.a.createElement("td",null,s.a.createElement(q.a,{className:se.includes("cwd")&&"error",value:D,onChange:function(e){A(e.target.value||"./")}}))),s.a.createElement("tr",null,s.a.createElement("td",{className:"td-left"},"Print command"),s.a.createElement("td",null,s.a.createElement(q.a,{className:se.includes("print")&&"error",value:B,onChange:function(e){return U(e.target.value)}}))),s.a.createElement("tr",null,s.a.createElement("td",{className:"td-left"},"Stages"),s.a.createElement("td",{className:se.includes("stages")&&"error"},s.a.createElement(we,{stages:Y,onStagesChange:$})))],"cloudformation"===n&&[s.a.createElement("tr",null,s.a.createElement("td",{className:"td-left"},"Title"),s.a.createElement("td",null,s.a.createElement(q.a,{className:se.includes("cfTitle")&&"error",placeholder:"Service Title",value:O,onChange:function(e){return w(e.target.value)}}))),s.a.createElement("tr",null,s.a.createElement("td",{colSpan:2},s.a.createElement(Ie,{source:n,awsProfile:u,defaultStages:e.stacks,defaultRegion:e.region,onChange:function(e){te(e)}})))],"custom"===n&&[s.a.createElement("tr",null,s.a.createElement("td",{className:"td-left"},"Title"),s.a.createElement("td",null,s.a.createElement(q.a,{className:se.includes("customTitle")&&"error",placeholder:"Service Title",value:N,onChange:function(e){return P(e.target.value)}}))),s.a.createElement("tr",null,s.a.createElement("td",{colSpan:2},Object.entries(he).map((function(t){var a=Object(c.a)(t,2),r=a[0];a[1];return s.a.createElement("div",{className:"tabs-wrapper-item",key:r},s.a.createElement(Ie,{source:n,awsProfile:u,defaultStages:e.stacks,defaultRegion:e.region,onChange:function(e){pe(Fe({},he,Object(h.a)({},r,e)))}}),s.a.createElement(m.a,{type:"close",className:"remove-log-item",onClick:function(){var e=he;delete e[r],pe(Fe({},e))}}))})),s.a.createElement(Q.a,{style:{float:"right"},className:"submit-button",onClick:function(){var e=Object.keys(he).length;pe(Fe({},he,Object(h.a)({},"".concat(e,"-").concat(Math.random()),[{stage:"dev"}])))}},"Add Log Group")))]),s.a.createElement(Q.a,{loading:Oe,className:"submit-button",onClick:Ne},"Add Service"),s.a.createElement("div",{className:"error-desc-wrap"},ce.map((function(e,t){return e.length>150?s.a.createElement("textarea",{value:e,className:"errortextarea",readOnly:!0}):s.a.createElement("p",null,e)}))),fe&&s.a.createElement("div",null,fe))}a(331);o.a.render("createService"===document.vscodeData.page?s.a.createElement((function(){return s.a.createElement("div",{className:"create-page-root"},s.a.createElement("div",null,s.a.createElement(De,{awsProfile:"default",source:"serverless",cwd:"./",offset:0,print:"serverless print",region:"us-east-1",stages:["dev"],stacks:[{stage:"dev",stackName:null}],customLogs:{"0-default":[{stage:"dev",logGroup:null}]}})))}),null):s.a.createElement((function(){var e=Object(r.useState)([document.vscodeData.tabs[0].page||"logs"]),t=Object(c.a)(e,2),a=t[0],n=t[1],o=Object(r.useState)(document.vscodeData.tabs[0].page||"logs"),h=Object(c.a)(o,2),p=h[0],g=h[1],d=Object(r.useState)(document.vscodeData.tabs[0].title),f=Object(c.a)(d,2),v=f[0],b=f[1],y=Object(r.useState)(document.vscodeData.autoRefreshInterval),E=Object(c.a)(y,2),S=E[0],O=E[1];return s.a.createElement("div",null,s.a.createElement("div",{className:"sidebar"},s.a.createElement("div",{className:"logs"===p?"sidebar-item active":"sidebar-item",onClick:function(){g("logs"),n(a.includes("logs")?a:[].concat(Object(i.a)(a),["logs"]))}},s.a.createElement(u.a,{placement:"right",title:"Last Logs",mouseEnterDelay:0,mouseLeaveDelay:0},s.a.createElement(m.a,{type:"unordered-list"}))),s.a.createElement("div",{className:"search"===p?"sidebar-item active":"sidebar-item",onClick:function(){g("search"),n(a.includes("search")?a:[].concat(Object(i.a)(a),["search"]))}},s.a.createElement(u.a,{placement:"right",title:"Search Logs",mouseEnterDelay:0,mouseLeaveDelay:0},s.a.createElement(m.a,{type:"file-search"})))),s.a.createElement("div",{className:"main-wrapper"},s.a.createElement(l.a,{animated:!1,onChange:function(e){b(e)}},document.vscodeData.tabs.map((function(e){return s.a.createElement(ye,{tab:e.title,key:e.title},a.includes("search")&&s.a.createElement("div",{style:{display:"search"===p?"block":"none"}},s.a.createElement(de,{logGroupName:e.logs,region:e.region})),a.includes("logs")&&s.a.createElement("div",{style:{display:"logs"===p?"block":"none"}},s.a.createElement(re,{tab:e,isActive:"logs"===p&&v===e.title,autoRefreshInterval:S,onAutoRefreshChange:function(e){document.vscodeData.autoRefreshInterval=e,O(e)}})))})))))}),null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[171,1,2]]]);